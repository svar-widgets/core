{
  "version": 3,
  "sources": ["../../svelte-spa-router/active.js"],
  "sourcesContent": ["import {parse} from 'regexparam'\nimport {loc} from './Router.svelte'\n\n// List of nodes to update\nconst nodes = []\n\n// Current location\nlet location\n\n// Function that updates all nodes marking the active ones\nfunction checkActive(el) {\n    const matchesLocation = el.pattern.test(location)\n    toggleClasses(el, el.className, matchesLocation)\n    toggleClasses(el, el.inactiveClassName, !matchesLocation)\n}\n\nfunction toggleClasses(el, className, shouldAdd) {\n    (className || '').split(' ').forEach((cls) => {\n        if (!cls) {\n            return\n        }\n        // Remove the class firsts\n        el.node.classList.remove(cls)\n\n        // If the pattern doesn't match, then set the class\n        if (shouldAdd) {\n            el.node.classList.add(cls)\n        }\n    })\n}\n\n// Listen to changes in the location\nloc.subscribe((value) => {\n    // Update the location\n    location = value.location + (value.querystring ? '?' + value.querystring : '')\n\n    // Update all nodes\n    nodes.map(checkActive)\n})\n\n/**\n * @typedef {Object} ActiveOptions\n * @property {string|RegExp} [path] - Path expression that makes the link active when matched (must start with '/' or '*'); default is the link's href\n * @property {string} [className] - CSS class to apply to the element when active; default value is \"active\"\n */\n\n/**\n * Svelte Action for automatically adding the \"active\" class to elements (links, or any other DOM element) when the current location matches a certain path.\n * \n * @param {HTMLElement} node - The target node (automatically set by Svelte)\n * @param {ActiveOptions|string|RegExp} [opts] - Can be an object of type ActiveOptions, or a string (or regular expressions) representing ActiveOptions.path.\n * @returns {{destroy: function(): void}} Destroy function\n */\nexport default function active(node, opts) {\n    // Check options\n    if (opts && (typeof opts == 'string' || (typeof opts == 'object' && opts instanceof RegExp))) {\n        // Interpret strings and regular expressions as opts.path\n        opts = {\n            path: opts\n        }\n    }\n    else {\n        // Ensure opts is a dictionary\n        opts = opts || {}\n    }\n\n    // Path defaults to link target\n    if (!opts.path && node.hasAttribute('href')) {\n        opts.path = node.getAttribute('href')\n        if (opts.path && opts.path.length > 1 && opts.path.charAt(0) == '#') {\n            opts.path = opts.path.substring(1)\n        }\n    }\n\n    // Default class name\n    if (!opts.className) {\n        opts.className = 'active'\n    }\n\n    // If path is a string, it must start with '/' or '*'\n    if (!opts.path || \n        typeof opts.path == 'string' && (opts.path.length < 1 || (opts.path.charAt(0) != '/' && opts.path.charAt(0) != '*'))\n    ) {\n        throw Error('Invalid value for \"path\" argument')\n    }\n\n    // If path is not a regular expression already, make it\n    const {pattern} = typeof opts.path == 'string' ?\n        parse(opts.path) :\n        {pattern: opts.path}\n\n    // Add the node to the list\n    const el = {\n        node,\n        className: opts.className,\n        inactiveClassName: opts.inactiveClassName,\n        pattern\n    }\n    nodes.push(el)\n\n    // Trigger the action right away\n    checkActive(el)\n\n    return {\n        // When the element is destroyed, remove it from the list\n        destroy() {\n            nodes.splice(nodes.indexOf(el), 1)\n        }\n    }\n}\n"],
  "mappings": ";;;;;;;;;;;;AAIA,IAAM,QAAQ,CAAC;AAGf,IAAI;AAGJ,SAAS,YAAY,IAAI;AACrB,QAAM,kBAAkB,GAAG,QAAQ,KAAK,QAAQ;AAChD,gBAAc,IAAI,GAAG,WAAW,eAAe;AAC/C,gBAAc,IAAI,GAAG,mBAAmB,CAAC,eAAe;AAC5D;AAEA,SAAS,cAAc,IAAI,WAAW,WAAW;AAC7C,GAAC,aAAa,IAAI,MAAM,GAAG,EAAE,QAAQ,CAAC,QAAQ;AAC1C,QAAI,CAAC,KAAK;AACN;AAAA,IACJ;AAEA,OAAG,KAAK,UAAU,OAAO,GAAG;AAG5B,QAAI,WAAW;AACX,SAAG,KAAK,UAAU,IAAI,GAAG;AAAA,IAC7B;AAAA,EACJ,CAAC;AACL;AAGA,IAAI,UAAU,CAAC,UAAU;AAErB,aAAW,MAAM,YAAY,MAAM,cAAc,MAAM,MAAM,cAAc;AAG3E,QAAM,IAAI,WAAW;AACzB,CAAC;AAec,SAAR,OAAwB,MAAM,MAAM;AAEvC,MAAI,SAAS,OAAO,QAAQ,YAAa,OAAO,QAAQ,YAAY,gBAAgB,SAAU;AAE1F,WAAO;AAAA,MACH,MAAM;AAAA,IACV;AAAA,EACJ,OACK;AAED,WAAO,QAAQ,CAAC;AAAA,EACpB;AAGA,MAAI,CAAC,KAAK,QAAQ,KAAK,aAAa,MAAM,GAAG;AACzC,SAAK,OAAO,KAAK,aAAa,MAAM;AACpC,QAAI,KAAK,QAAQ,KAAK,KAAK,SAAS,KAAK,KAAK,KAAK,OAAO,CAAC,KAAK,KAAK;AACjE,WAAK,OAAO,KAAK,KAAK,UAAU,CAAC;AAAA,IACrC;AAAA,EACJ;AAGA,MAAI,CAAC,KAAK,WAAW;AACjB,SAAK,YAAY;AAAA,EACrB;AAGA,MAAI,CAAC,KAAK,QACN,OAAO,KAAK,QAAQ,aAAa,KAAK,KAAK,SAAS,KAAM,KAAK,KAAK,OAAO,CAAC,KAAK,OAAO,KAAK,KAAK,OAAO,CAAC,KAAK,MACjH;AACE,UAAM,MAAM,mCAAmC;AAAA,EACnD;AAGA,QAAM,EAAC,QAAO,IAAI,OAAO,KAAK,QAAQ,WAClC,MAAM,KAAK,IAAI,IACf,EAAC,SAAS,KAAK,KAAI;AAGvB,QAAM,KAAK;AAAA,IACP;AAAA,IACA,WAAW,KAAK;AAAA,IAChB,mBAAmB,KAAK;AAAA,IACxB;AAAA,EACJ;AACA,QAAM,KAAK,EAAE;AAGb,cAAY,EAAE;AAEd,SAAO;AAAA;AAAA,IAEH,UAAU;AACN,YAAM,OAAO,MAAM,QAAQ,EAAE,GAAG,CAAC;AAAA,IACrC;AAAA,EACJ;AACJ;",
  "names": []
}
